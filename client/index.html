<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ChatGPT AI</title>
    <link rel="stylesheet" href="style.css" />
    <style>
      .blur {
        filter: blur(2px);
      }
    </style>
  </head>
  
  <body onload="initChat(); initNewsFeed();">
    
    <div id="news-container"></div>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
      function initNewsFeed() {
        //alert('..successfully run!');
        const url = 'https://newsapi.org/v2/top-headlines?country=us&category=business&q=bitcoin&apiKey=4c7b3dd6ff024a2a878f173ef2391f2f';
        const xhr = new XMLHttpRequest();
        xhr.open('GET', url, true);

        xhr.onload = function() {
          if (xhr.status === 200) {
            const response = JSON.parse(xhr.responseText);
            const articles = response.articles;
            // Create HTML string to render articles
            const articleHTML = articles
              .map(article => {
                return `
                  <div>
                    <h2>${article.title}</h2>
                    <p>${article.description}</p>
                    <a href="${article.url}">Read more</a>
                  </div>
                `;
              })
              .join('');
            // Render articles to the news-container div
            const newsContainer = document.getElementById('news-container');
            if (newsContainer) {
              newsContainer.innerHTML = articleHTML;
              // Display success message
              alert('News articles successfully loaded!');
            } else {
              console.log('News container not found.');
              alert('News container not found.');
            }
          } else {
            console.log('Request failed.  Returned status of ' + xhr.status);
            // Display error message
            alert('Failed to load news articles.');
          }
        };

        xhr.onerror = function() {
          console.log('Request failed.  There was a network error.');
          // Display error message
          alert('Failed to load news articles.');
        };

        xhr.send();
      }


    </script>

    
    <div id="app">
      <div id="chat_container">
        <div id="message_wrapper"></div>
      </div>
      <form id="chatForm">
        <textarea
          id="promptTextarea"
          name="prompt"
          rows="1"
          cols="1"
          style="overflow:auto;"
          placeholder="Ask anything..."
        ></textarea>
        <button id="sendButton" type="submit"><img src="assets/send.svg" alt="send" /></button>
      </form>
      <!-- New div with invisible style -->
      <div id="hidden_text">Ask anything...</div>
    </div>
    <script type="module" src="script.js"></script>
    <script>
      function initChat() {
        var promptTextarea = document.getElementById("promptTextarea");
        var sendButton = document.getElementById("sendButton");
        var isFirstTime = localStorage.getItem("isFirstTime");
        if (!isFirstTime) {
          var greetings = [
            "Hello!",
            "Greetings!",
            "Good day!",
            "Welcome!",
            "Salutations!",
            "Hi there!",
            "How can I assist you today?",
            "Pleasure to meet you!",
          ];
          var randomIndex = Math.floor(Math.random() * greetings.length);
          var randomGreeting = greetings[randomIndex];
          promptTextarea.value = randomGreeting;
          sendButton.click();
          // Store the information that it's not the first time
          localStorage.setItem("isFirstTime", "false");
        }
      }
    </script>

  </body>
</html>
